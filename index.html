<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>BOOOKS BOOKS BOOKS</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div id="wrapper">

      <div class="input-group-lg">
        <input type="text" id="searchbar" onkeypress="search(event)" class="form-control" placeholder="Enter the keyword and hit ENTER" aria-describedby="sizing-addon1">
      </div>
      
      <div id="output"></div>

    </div>

    <script>
        var name = "";
        var content = "";
        var img = "";
        var connect = document.querySelector('#connect');
        var output = document.querySelector("#output");
        var searchbar = document.querySelector("#searchbar");
        var url = "https://www.googleapis.com/books/v1/volumes?q="+name;

        function search(event){
            if(event.which === 13 || event.keyCode === 13){
              output.innerHTML = "";
              name = searchbar.value;
              handleResponse(JSON.parse(httpGet("https://www.googleapis.com/books/v1/volumes?q="+name+"&maxResults=40")));
            }
        }  
        function httpGet(theUrl){
          var xmlHttp = null;
          xmlHttp = new XMLHttpRequest();
          xmlHttp.open( "GET", theUrl, false );
          xmlHttp.send( null );
          return xmlHttp.responseText;
        }
        function handleResponse(response){
          for (var i=0; i < response.items.length; i++) {
            var item = response.items[i];
            console.log(item.volumeInfo);


            content = '<div class="media">';
            if(item.volumeInfo.imageLinks)  img = item.volumeInfo.imageLinks.smallThumbnail;
            else img = "http://placehold.it/130x190";
            content += '<div class="media-left"><a href="#"><img class="media-object" src="'+img+'" alt="..."></a></div><div class="media-body"><h4 class="media-heading">'+item.volumeInfo.title+'</h4>';
            if(item.volumeInfo.subtitle !== undefined) content += '<h5 class="media-heading">'+item.volumeInfo.subtitle+'</h5>';
            if(item.volumeInfo.description !== undefined) content += item.volumeInfo.description;
            content += '</div></div>';
            if(item.volumeInfo.industryIdentifiers) content += '<a href="http://www.amazon.com/gp/search/ref=sr_adv_b/?search-alias=stripbooks&unfiltered=1&field-keywords=&field-author=&field-title=&field-isbn='+item.volumeInfo.industryIdentifiers[0].identifier+'&field-publisher=&node=&field-p_n_condition-type=&field-feature_browse-bin=&field-subject=&field-language=&field-dateop=During&field-datemod=&field-dateyear=&sort=relevanceexprank&Adv-Srch-Books-Submit.x=46&Adv-Srch-Books-Submit.y=21" title="" target="_blank"><button type="button" class="btn btn-warning">Go Amazon</button></a>';
            output.innerHTML += content;
          }
        }
    </script>

  </body>
</html>